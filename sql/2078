/*

Consider all LinkedIn users who, at some point, worked at Microsoft. For how many of them was Google their next employer right after Microsoft (no employers in between)?
Table: linkedin_users

user_id:            int
employer:           varchar
position:           varchar
start_date:         datetime
end_date:           datetime

*/

WITH data AS (
    SELECT user_id, employer, 
           ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY start_date) AS company_order
    FROM linkedin_users
    WHERE employer IN ('Microsoft', 'Google')
    )


SELECT user_id
FROM data
GROUP BY user_id
HAVING SUM(CASE WHEN employer = 'Google' THEN company_order END) - SUM(CASE WHEN employer = 'Microsoft' THEN company_order END) = 1
